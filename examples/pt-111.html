<html>
<head>
<title>ASE atomic visualization</title>
<link rel="stylesheet" type="text/css"
 href="https://www.x3dom.org/x3dom/release/x3dom.css">
</link>
<script type="text/javascript"
 src="https://www.x3dom.org/x3dom/release/x3dom.js">
</script>
<style>
* {
    box-sizing: border-box;
  }
 
/* Create two unequal columns that floats next to each other */
.column {
  float: left;
  padding: 10px;
}

.left {
  width: 25%;
}

.right {
  width: 75%;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

#x3dase{
    top:0;
    width: 80%;
    height: 80%;
    border:2px solid darkorange;        
}

#sidebar{
    top:0;
    border:2px solid darkorange;        
}</style></head>
<body>

<div class = "column left", id = "sidebar">

<p>Models: <br>
<button type="button" onclick="spacefilling('3cd59d73')">Space-filling</button>
<button type="button" onclick="ballstick('3cd59d73')">Ball-and-stick</button>
<button type="button" onclick="polyhedra('3cd59d73')">Polyhedra</button>   
<br>
Labels: <br>
<button type="button" onclick="none('3cd59d73')">None</button>
<button type="button" onclick="element('3cd59d73')"> Element</button>
<button type="button" onclick="index('3cd59d73')">Index</button>

<div id="camera_buttons" style="display: block;">
<br>
Camera:<br>
    <button onclick="document.getElementById('camera_ortho_3cd59d73').setAttribute('set_bind','true');">Orthographic <br></button>
    <button onclick="document.getElementById('camera_persp_3cd59d73').setAttribute('set_bind','true');">Perspective <br></button>
<br>
View:<br>
    <button  onclick="set_viewpoint('3cd59d73', 'top')">Top<br></button>
    <button  onclick="set_viewpoint('3cd59d73', 'front')">Front<br></button>
    <button  onclick="set_viewpoint('3cd59d73', 'right')">Right<br></button>
    <button onclick="set_viewpoint('3cd59d73', 'left')">Left <br></button>
</div>

</p>
    <table style="font-size:1.0em;">
        <tr><td>Element: </td><td id="lastonMouseoverObject_kind_3cd59d73">-</td> <td> <td id="lastonMouseoverObject_index_3cd59d73">-</td> <td>  </td><td id="position_3cd59d73">-</td></tr>
    </table>
<p id="distance_3cd59d73"></p>
<p id="error_3cd59d73"></p>

</div>
 <div class = "column right" > 
   <X3D id = "x3dase" PrimitiveQuality = "high" > 
     <Scene > 
       <Transform id = "t_camera_persp_3cd59d73" rotation = "0 0 0 0" > 
         <Viewpoint id = "camera_persp_3cd59d73" position = "0.46197643037521113 0.8001666493091714 7.064212951078362" centerOfRotation = "0.46197643037521113 0.8001666493091714 2.2632130552233334" orientation = "0 0 0 0" description = "camera" > 
         </Viewpoint> 
       </Transform> 
       <Transform id = "t_camera_ortho_3cd59d73" rotation = "0 0 0 0" > 
         <OrthoViewpoint id = "camera_ortho_3cd59d73" position = "0.46197643037521113 0.8001666493091714 7.064212951078362" centerOfRotation = "0.46197643037521113 0.8001666493091714 2.2632130552233334" orientation = "0 0 0 0" fieldOfView = "-1.6003332986183427 -1.6003332986183427 1.6003332986183427 1.6003332986183427" description = "camera" > 
         </OrthoViewpoint> 
       </Transform> 
       <Group > 
         <Switch whichChoice = "-1" > 
           <Shape DEF = "as_Pt" id = "as_Pt_3cd59d73" > 
             <Appearance DEF = "app_Pt" > 
               <Material name = "am_3cd59d73" diffuseColor = "0.816 0.816 0.878" transparency = "0.01" > 
               </Material> 
             </Appearance> 
             <Sphere DEF = "asp_Pt" radius = "1.36" > 
             </Sphere> 
           </Shape> 
         </Switch> 
         <Fontstyle DEF = "Fontstyle" family = "SANS" size = "1.2363636363636363" > 
         </Fontstyle> 
         <Appearance DEF = "text_app_Pt" > 
           <Material diffuseColor = "0 0 0" > 
           </Material> 
         </Appearance> 
         <Switch whichChoice = "-1" > 
           <Billboard DEF = "billboard_Pt" axisOfRotation = "0 0 0" > 
             <Shape DEF = "Pt" id = "as_3cd59d73" > 
               <Appearance DEF = "text_app_Pt" > 
                 <Material diffuseColor = "0 0 0" > 
                 </Material> 
               </Appearance> 
               <Text string = "Pt" solid = "true" > 
                 <Fontstyle DEF = "Fontstyle" family = "SANS" size = "1.2363636363636363" > 
                 </Fontstyle> 
               </Text> 
             </Shape> 
           </Billboard> 
         </Switch> 
         <Transform uuid = "3cd59d73" id = "at_0_3cd59d73" name = "at_3cd59d73" translation = "1.39 0.8 0.0" > 
           <Shape kind = "Pt" index = "0" uuid = "3cd59d73" > 
             <Appearance USE = "app_Pt" > 
             </Appearance> 
             <Sphere USE = "asp_Pt" > 
             </Sphere> 
           </Shape> 
         </Transform> 
         <Transform uuid = "3cd59d73" id = "at_1_3cd59d73" name = "at_3cd59d73" translation = "-0.0 1.6 2.26" > 
           <Shape kind = "Pt" index = "1" uuid = "3cd59d73" > 
             <Appearance USE = "app_Pt" > 
             </Appearance> 
             <Sphere USE = "asp_Pt" > 
             </Sphere> 
           </Shape> 
         </Transform> 
         <Transform uuid = "3cd59d73" id = "at_2_3cd59d73" name = "at_3cd59d73" translation = "0.0 0.0 4.53" > 
           <Shape kind = "Pt" index = "2" uuid = "3cd59d73" > 
             <Appearance USE = "app_Pt" > 
             </Appearance> 
             <Sphere USE = "asp_Pt" > 
             </Sphere> 
           </Shape> 
         </Transform> 
       </Group> 
       <Switch id = "ele_3cd59d73" whichChoice = "-1" > 
         <Group > 
           <Transform translation = "1.39 0.8 0.0" > 
             <Billboard USE = "billboard_Pt" axisOfRotation = "0 0 0" > 
             </Billboard> 
           </Transform> 
           <Transform translation = "-0.0 1.6 2.26" > 
             <Billboard USE = "billboard_Pt" axisOfRotation = "0 0 0" > 
             </Billboard> 
           </Transform> 
           <Transform translation = "0.0 0.0 4.53" > 
             <Billboard USE = "billboard_Pt" axisOfRotation = "0 0 0" > 
             </Billboard> 
           </Transform> 
         </Group> 
       </Switch> 
       <Switch id = "ind_3cd59d73" whichChoice = "-1" > 
         <Group > 
           <Transform translation = "1.39 0.8 0.0" > 
             <Billboard axisOfRotation = "0 0 0" > 
               <Shape > 
                 <Appearance USE = "text_app_Pt" > 
                 </Appearance> 
                 <Text string = "0" solid = "true" > 
                   <Fontstyle USE = "Fontstyle" > 
                   </Fontstyle> 
                 </Text> 
               </Shape> 
             </Billboard> 
           </Transform> 
           <Transform translation = "-0.0 1.6 2.26" > 
             <Billboard axisOfRotation = "0 0 0" > 
               <Shape > 
                 <Appearance USE = "text_app_Pt" > 
                 </Appearance> 
                 <Text string = "1" solid = "true" > 
                   <Fontstyle USE = "Fontstyle" > 
                   </Fontstyle> 
                 </Text> 
               </Shape> 
             </Billboard> 
           </Transform> 
           <Transform translation = "0.0 0.0 4.53" > 
             <Billboard axisOfRotation = "0 0 0" > 
               <Shape > 
                 <Appearance USE = "text_app_Pt" > 
                 </Appearance> 
                 <Text string = "2" solid = "true" > 
                   <Fontstyle USE = "Fontstyle" > 
                   </Fontstyle> 
                 </Text> 
               </Shape> 
             </Billboard> 
           </Transform> 
         </Group> 
       </Switch> 
       <Shape > 
         <IndexedLineSet coordIndex = "0 1 -1 0 2 -1 0 4 -1 1 3 -1 1 5 -1 2 3 -1 2 6 -1 3 7 -1 4 5 -1 4 6 -1 5 7 -1 6 7 -1" > 
           <Coordinate point = "[[ 0.          0.          0.          0.          0.         14.52642611
   1.38592929  2.40049995  0.          1.38592929  2.40049995 14.52642611
   2.77185858  0.          0.          2.77185858  0.         14.52642611
   4.15778787  2.40049995  0.          4.15778787  2.40049995 14.52642611]]" > 
           </Coordinate> 
         </IndexedLineSet> 
         <Appearance > 
           <Material diffuseColor = "0 0 0" emissiveColor = "0 0.5 1" > 
           </Material> 
         </Appearance> 
       </Shape> 
       <Switch whichChoice = "-1" > 
         <Shape DEF = "Pt" > 
           <Appearance > 
             <Material diffuseColor = "0.816 0.816 0.878" transparency = "0.01" > 
             </Material> 
           </Appearance> 
           <Cylinder height = "1.0" radius = "0.1" subdivision = "8" > 
           </Cylinder> 
         </Shape> 
       </Switch> 
       <Switch id = "bs_3cd59d73" whichChoice = "0" > 
         <Group > 
           <Transform translation = "1.73 1.0 0.57" scale = "1 1.39 1" rotation = "-0.8528 0.0 0.5222 1.8636" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "1.04 0.2 0.0" scale = "1 1.39 1" rotation = "-0.0 0.0 -1.0 0.5236" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "1.39 0.4 0.57" scale = "1 1.39 1" rotation = "-1.0 0.0 0.0 0.9553" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "2.08 0.8 0.0" scale = "1 1.39 1" rotation = "0.0 -0.0 1.0 1.5708" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "1.04 1.4 0.0" scale = "1 1.39 1" rotation = "0.0 0.0 -1.0 2.618" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "1.04 1.0 0.57" scale = "1 1.39 1" rotation = "-0.8528 0.0 -0.5222 1.8636" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.69 0.8 0.0" scale = "1 1.39 1" rotation = "0.0 0.0 -1.0 1.5708" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "1.73 1.4 0.0" scale = "1 1.39 1" rotation = "0.0 -0.0 1.0 2.618" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "1.73 0.2 0.0" scale = "1 1.39 1" rotation = "-0.0 -0.0 1.0 0.5236" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.0 2.0 1.7" scale = "1 1.39 1" rotation = "1.0 -0.0 -0.0 2.1863" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 1.8 2.83" scale = "1 1.39 1" rotation = "-0.8528 0.0 -0.5222 1.8636" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 1.8 2.83" scale = "1 1.39 1" rotation = "-0.8528 0.0 0.5222 1.8636" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 2.2 2.26" scale = "1 1.39 1" rotation = "0.0 0.0 -1.0 2.618" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 2.2 2.26" scale = "1 1.39 1" rotation = "0.0 -0.0 1.0 2.618" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.0 1.2 2.83" scale = "1 1.39 1" rotation = "-1.0 0.0 0.0 0.9553" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 1.0 2.26" scale = "1 1.39 1" rotation = "-0.0 0.0 -1.0 0.5236" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 1.0 2.26" scale = "1 1.39 1" rotation = "-0.0 -0.0 1.0 0.5236" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.69 1.6 2.26" scale = "1 1.39 1" rotation = "0.0 0.0 -1.0 1.5708" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 1.4 1.7" scale = "1 1.39 1" rotation = "0.8528 -0.0 -0.5222 1.278" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 1.4 1.7" scale = "1 1.39 1" rotation = "0.8528 -0.0 0.5222 1.278" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.69 1.6 2.26" scale = "1 1.39 1" rotation = "0.0 -0.0 1.0 1.5708" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.69 0.0 4.53" scale = "1 1.39 1" rotation = "0.0 -0.0 1.0 1.5708" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.0 0.4 3.96" scale = "1 1.39 1" rotation = "1.0 -0.0 -0.0 2.1863" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 -0.2 3.96" scale = "1 1.39 1" rotation = "0.8528 -0.0 -0.5222 1.278" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 -0.2 3.96" scale = "1 1.39 1" rotation = "0.8528 -0.0 0.5222 1.278" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 -0.6 4.53" scale = "1 1.39 1" rotation = "-0.0 0.0 -1.0 0.5236" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 -0.6 4.53" scale = "1 1.39 1" rotation = "-0.0 -0.0 1.0 0.5236" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "0.35 0.6 4.53" scale = "1 1.39 1" rotation = "0.0 -0.0 1.0 2.618" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.35 0.6 4.53" scale = "1 1.39 1" rotation = "0.0 0.0 -1.0 2.618" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
           <Transform translation = "-0.69 0.0 4.53" scale = "1 1.39 1" rotation = "0.0 0.0 -1.0 1.5708" > 
             <Shape USE = "Pt" > 
             </Shape> 
           </Transform> 
         </Group> 
       </Switch> 
     </Scene> 
   </X3D> 
 </div> 

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.0.min.js" ></script>
 <script >
let atoms_dict = {com: "0.46 0.80 2.26", 
top_pos: "0.46 0.80 7.06", 
front_pos: "0.46 -4.00 2.26", 
right_pos: "5.26 0.80 2.26", 
left_pos: "-4.34 0.80 2.26", 
uuid: "3cd59d73", 
label: "True", 
bond: "1.0", 
polyhedra: "{}", 
}//replace all uuid with real one.
let p1 = 'False';
let p2 = 'False';
let dist = '';
function set_viewpoint(uuid, view){
    $('#error_'.concat(atoms_dict['uuid'])).html('uuid: '.concat(atoms_dict["uuid"]));
    var persp = 'camera_persp_' + atoms_dict['uuid'];
    var ortho = 'camera_ortho_' + atoms_dict['uuid'];
    if (view == "top") {
        document.getElementById(persp).setAttribute('orientation','0 0 0 0');
        document.getElementById(persp).setAttribute('position', atoms_dict['top_pos']);
        document.getElementById(ortho).setAttribute('orientation','0 0 0 0');
        document.getElementById(ortho).setAttribute('position', atoms_dict['top_pos']);
    }
    else if (view == "front"){
        document.getElementById(persp).setAttribute('orientation','1 0 0 1.57079');
        document.getElementById(persp).setAttribute('position', atoms_dict['front_pos']);
        document.getElementById(ortho).setAttribute('orientation','1 0 0 1.57079');
        document.getElementById(ortho).setAttribute('position', atoms_dict['front_pos']);
        }
    else if (view == "right"){
        document.getElementById(persp).setAttribute('orientation','0 1 0 1.57079');
        document.getElementById(persp).setAttribute('position', atoms_dict['right_pos']);
        document.getElementById(ortho).setAttribute('orientation','0 1 0 1.57079');
        document.getElementById(ortho).setAttribute('position', atoms_dict['right_pos']);
    }
    else if (view == "left"){
        document.getElementById(persp).setAttribute('orientation','0 1 0 -1.57079');
        document.getElementById(persp).setAttribute('position', atoms_dict['left_pos']);
        document.getElementById(ortho).setAttribute('orientation','0 1 0 -1.57079');
        document.getElementById(ortho).setAttribute('position', atoms_dict['left_pos']);
    }
}

//Round a float value to x.xx format
function roundWithTwoDecimals(value)
{
    var x = (Math.round(value * 100)) / 100;
    var y = x.toFixed(2);
    return y;
}
        
//Add a onMouseover callback to every shape
$(document).ready(function(){
    $("shape").each(function() {
        $(this).attr("onMouseover", "handleOnMouseover_shape(this)");
        $(this).attr("onclick", "handleClick_shape(this)");
    });
    //Add a onMouseover callback to every transform
    $("transform").each(function() {
        $(this).attr("onMouseover", "handleOnMouseover_transform(this)");
        $(this).attr("onclick", "handleClick_transform(this)");
    });
});
//Handle onMouseover on a shape
function handleOnMouseover_shape(shape)
{
    var atom_kind = '#lastonMouseoverObject_kind_'.concat($(shape).attr("uuid"));
    var atom_index = '#lastonMouseoverObject_index_'.concat($(shape).attr("uuid"));
    $(atom_kind).html($(shape).attr("kind"));
    $(atom_index).html($(shape).attr("index"));
}
//Handle onMouseover on a transform
function handleOnMouseover_transform(transform)
{
    var atom_position = '#position_'.concat($(transform).attr("uuid"));
    var coord = $(transform).attr("translation").split(" ");
    var x = roundWithTwoDecimals(coord[0]);
    var y = roundWithTwoDecimals(coord[1]);
    var z = roundWithTwoDecimals(coord[2]);
    var position = 'x = ' + x + ' y = ' + y + ' z = ' + z;
    $(atom_position).html(position);
}
function handleClick_transform(transform)
{
    var distance = '#distance_'.concat($(transform).attr("uuid"));
    var id = $(transform).attr("id");
    if (p1 == 'False') { 
		p1 = id; 
        scale = document.getElementById(p1).getAttribute("translation");
    $('distance').html(dist);
		}
	else if(p2 == 'False') { 
		p2 = id; 
        calculate_distance(p1, p2);
        p1 = 'False';
        p2 = 'False';
        dist = '';
	}
}
function calculate_distance(p1, p2)
{
    var distance = '#distance_'.concat(document.getElementById(p1).getAttribute("uuid"));
    var c1 = document.getElementById(p1).getAttribute("translation").split(" ");
    var c2 = document.getElementById(p2).getAttribute("translation").split(" ");
    r = (c1[0] - c2[0])*(c1[0] - c2[0]) + (c1[1] - c2[1])*(c1[1] - c2[1]) + (c1[2] - c2[2])*(c1[2] - c2[2]);
    r = roundWithTwoDecimals(Math.sqrt(r));
    var dist = 'Distance:  ' + r;
    $(distance).html(dist);
    p1 = 'False';
    p2 = 'False';
}

//Handle models
function spacefilling(uuid)
{
    var objs = document.getElementsByName(''.concat('at_'.concat(uuid)));
    var max=objs.length;
    for (var i=0; i< max; i++) {
        objs[i].setAttribute("scale", "1.0, 1.0, 1.0");
        }
    document.getElementById('bs_'.concat(uuid)).setAttribute("whichChoice", '-1');
    document.getElementById('ps_'.concat(uuid)).setAttribute("whichChoice", '-1');
}
function ballstick(uuid)
{
    if (atoms_dict['bond']=='False'){ 
        alert('Please set bond parameter in your code, e.g. bond=1.0!');
    }
    var objs = document.getElementsByName(''.concat('at_'.concat(uuid)));
    var max=objs.length;
    for (var i=0; i< max; i++) {
        objs[i].setAttribute("scale", "0.6, 0.6, 0.6");
        }
    document.getElementById('bs_'.concat(uuid)).setAttribute("whichChoice", '0');
    document.getElementById('ps_'.concat(uuid)).setAttribute("whichChoice", '-1');
}
function polyhedra(uuid)
{
    if (atoms_dict['polyhedra']=='{}'){ 
        alert('Please set polyhedra parameter in your code, e.g. polyhedra={"Ti": ["O"]}!');
    }
    var objs = document.getElementsByName(''.concat('at_'.concat(uuid)));
    var max=objs.length;
    for (var i=0; i< max; i++) {
        objs[i].setAttribute("scale", "0.6, 0.6, 0.6");
        }
    document.getElementById('bs_'.concat(uuid)).setAttribute("whichChoice", '0');
    document.getElementById('ps_'.concat(uuid)).setAttribute("whichChoice", '0');
}
function none(uuid)
{
    var objs = document.getElementsByName(''.concat('am_'.concat(uuid)));
    var max=objs.length;
    for (var i=0; i< max; i++) {
        objs[i].setAttribute("transparency", "0.0");
        }
    document.getElementById('ele_'.concat(uuid)).setAttribute("whichChoice", '-1');
    document.getElementById('ind_'.concat(uuid)).setAttribute("whichChoice", '-1');
}
        
function element(uuid)
{
    if (atoms_dict['label']=='False'){ 
        $('#error_'.concat(uuid)).html('(^_^) To show element, please set label=True in your code!');
		return ;
	}
    var objs = document.getElementsByName(''.concat('am_'.concat(uuid)));
    var max=objs.length;
    for (var i=0; i< max; i++) {
        objs[i].setAttribute("transparency", "0.4");
        }
    document.getElementById('ele_'.concat(uuid)).setAttribute("whichChoice", '0');
    document.getElementById('ind_'.concat(uuid)).setAttribute("whichChoice", '-1');
    document.getElementById('bs_'.concat(uuid)).setAttribute("whichChoice", '-1');
}
function index(uuid)
{
    if (atoms_dict['label']=='False'){ 
        $('#error_'.concat(uuid)).html('(^_^) To show index, please set label=True in your code!');
		return ;
	}
    var objs = document.getElementsByName(''.concat('am_'.concat(uuid)));
    var max=objs.length;
    for (var i=0; i< max; i++) {
        objs[i].setAttribute("transparency", "0.4");
        }
    document.getElementById('ind_'.concat(uuid)).setAttribute("whichChoice", '0');
    document.getElementById('ele_'.concat(uuid)).setAttribute("whichChoice", '-1');
    document.getElementById('bs_'.concat(uuid)).setAttribute("whichChoice", '-1');
}</script> </body>
</html>
