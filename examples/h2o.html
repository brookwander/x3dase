<html>
<head>
<title>ASE atomic visualization</title>
<link rel="stylesheet" type="text/css"
 href="https://www.x3dom.org/x3dom/release/x3dom.css">
</link>
<script type="text/javascript"
 src="https://www.x3dom.org/x3dom/release/x3dom.js">
</script>
<style>
  .split {
    height: 100%;
    width: 50%;
    position: fixed;
    z-index: 1;
    top: 0;
    overflow-x: hidden;
    padding-top: 20px;
  }
  
  .left {
    left: 0;
    background-color: #111;
  }
  
  .right {
    right: 0;
    /* background-color: red; */
  }
  
  .centered {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
  }
  
  .centered img {
    width: 150px;
    border-radius: 50%;
  }
  </style>

</head>
<body>

 <div class="split left">

<p>Models: 
<button type="button" onclick="ballstick_f75210d2()">  Ball-and-stick</button>
<button type="button" onclick="spacefilling_f75210d2()"> Space-filling</button>
<button type="button" onclick="polyhedra_f75210d2()"> Polyhedra</button>   
Labels: 
<button type="button" onclick="none_f75210d2()"> none</button>
<button type="button" onclick="element_f75210d2()"> element</button>
<button type="button" onclick="index_f75210d2()"> index</button>

<div id="camera_buttons" style="display: block;">
Camera:
    <button onclick="document.getElementById('camera_ortho_f75210d2').setAttribute('set_bind','true');">Ortho <br></button>
    <button onclick="document.getElementById('camera_persp_f75210d2').setAttribute('set_bind','true');">Persp <br></button>
View:
    <button  onclick="set_viewpoint('top')">Top<br></button>
    <button  onclick="set_viewpoint('front')">Front<br></button>
    <button  onclick="set_viewpoint('right')">Right<br></button>
    <button onclick="set_viewpoint('left')">Left <br></button>
</div>

</p>
    <table style="font-size:1.0em;">
        <tr><td>Element: </td><td id="lastonMouseoverObject_kind_f75210d2">-</td> <td> <td id="lastonMouseoverObject_index_f75210d2">-</td> <td>  </td><td id="position_f75210d2">-</td></tr>
    </table>
<p id="error_f75210d2">-</p>
<p id="distance_f75210d2">-</p>

</div>

<div class="split right">

<X3D PrimitiveQuality="high" width="80%" height="80%">
<Scene>
 <Transform id = "t_camera_persp_f75210d2" rotation = "0 0 0 0" > 
   <Viewpoint id = "camera_persp_f75210d2" position = "0.0 0.0 4.631965001165695" centerOfRotation = "0.0 0.0 0.05253100116569526" orientation = "0 0 0 0" description = "camera" > 
   </Viewpoint> 
 </Transform> 
 <Transform id = "t_camera_ortho_f75210d2" rotation = "0 0 0 0" > 
   <OrthoViewpoint id = "camera_ortho_f75210d2" position = "0.0 0.0 4.631965001165695" centerOfRotation = "0.0 0.0 0.05253100116569526" orientation = "0 0 0 0" fieldOfView = "-1.526478 -1.526478 1.526478 1.526478" description = "camera" > 
   </OrthoViewpoint> 
 </Transform> 
 <Group > 
   <Switch whichChoice = "-1" > 
     <Shape DEF = "as_H" id = "as_H_f75210d2" > 
       <Appearance DEF = "app_H" > 
         <Material name = "am_f75210d2" diffuseColor = "1.0 1.0 1.0" transparency = "0.01" > 
         </Material> 
       </Appearance> 
       <Sphere DEF = "asp_H" radius = "0.31" > 
       </Sphere> 
     </Shape> 
   </Switch> 
   <Fontstyle DEF = "Fontstyle" family = "SANS" size = "0.2818181818181818" > 
   </Fontstyle> 
   <Appearance DEF = "text_app_H" > 
     <Material diffuseColor = "0 0 0" > 
     </Material> 
   </Appearance> 
   <Switch whichChoice = "-1" > 
     <Billboard DEF = "billboard_H" axisOfRotation = "0 0 0" > 
       <Shape DEF = "H" id = "as_f75210d2" > 
         <Appearance DEF = "text_app_H" > 
           <Material diffuseColor = "0 0 0" > 
           </Material> 
         </Appearance> 
         <Text string = "H" solid = "true" > 
           <Fontstyle DEF = "Fontstyle" family = "SANS" size = "0.2818181818181818" > 
           </Fontstyle> 
         </Text> 
       </Shape> 
     </Billboard> 
   </Switch> 
   <Transform id = "at_1_f75210d2" name = "at_f75210d2" translation = "0.0 0.76 -0.48" > 
     <Shape kind = "H" index = "1" > 
       <Appearance USE = "app_H" > 
       </Appearance> 
       <Sphere USE = "asp_H" > 
       </Sphere> 
     </Shape> 
   </Transform> 
   <Transform id = "at_2_f75210d2" name = "at_f75210d2" translation = "0.0 -0.76 -0.48" > 
     <Shape kind = "H" index = "2" > 
       <Appearance USE = "app_H" > 
       </Appearance> 
       <Sphere USE = "asp_H" > 
       </Sphere> 
     </Shape> 
   </Transform> 
   <Switch whichChoice = "-1" > 
     <Shape DEF = "as_O" id = "as_O_f75210d2" > 
       <Appearance DEF = "app_O" > 
         <Material name = "am_f75210d2" diffuseColor = "1.0 0.051 0.051" transparency = "0.01" > 
         </Material> 
       </Appearance> 
       <Sphere DEF = "asp_O" radius = "0.66" > 
       </Sphere> 
     </Shape> 
   </Switch> 
   <Fontstyle DEF = "Fontstyle" family = "SANS" size = "0.6" > 
   </Fontstyle> 
   <Appearance DEF = "text_app_O" > 
     <Material diffuseColor = "0 0 0" > 
     </Material> 
   </Appearance> 
   <Switch whichChoice = "-1" > 
     <Billboard DEF = "billboard_O" axisOfRotation = "0 0 0" > 
       <Shape DEF = "O" id = "as_f75210d2" > 
         <Appearance DEF = "text_app_O" > 
           <Material diffuseColor = "0 0 0" > 
           </Material> 
         </Appearance> 
         <Text string = "O" solid = "true" > 
           <Fontstyle DEF = "Fontstyle" family = "SANS" size = "0.6" > 
           </Fontstyle> 
         </Text> 
       </Shape> 
     </Billboard> 
   </Switch> 
   <Transform id = "at_0_f75210d2" name = "at_f75210d2" translation = "0.0 0.0 0.12" > 
     <Shape kind = "O" index = "0" > 
       <Appearance USE = "app_O" > 
       </Appearance> 
       <Sphere USE = "asp_O" > 
       </Sphere> 
     </Shape> 
   </Transform> 
 </Group> 
 <Switch whichChoice = "-1" > 
   <Shape DEF = "H" > 
     <Appearance > 
       <Material diffuseColor = "1.0 1.0 1.0" transparency = "0.01" > 
       </Material> 
     </Appearance> 
     <Cylinder height = "1.0" radius = "0.1" subdivision = "8" > 
     </Cylinder> 
   </Shape> 
 </Switch> 
 <Switch whichChoice = "-1" > 
   <Shape DEF = "O" > 
     <Appearance > 
       <Material diffuseColor = "1.0 0.051 0.051" transparency = "0.01" > 
       </Material> 
     </Appearance> 
     <Cylinder height = "1.0" radius = "0.1" subdivision = "8" > 
     </Cylinder> 
   </Shape> 
 </Switch> 
 <Switch id = "bs_f75210d2" whichChoice = "0" > 
   <Group > 
     <Transform translation = "0.0 0.57 -0.33" scale = "1 0.48 1" rotation = "-1.0 0.0 0.0 0.6632" > 
       <Shape USE = "H" > 
       </Shape> 
     </Transform> 
     <Transform translation = "0.0 -0.57 -0.33" scale = "1 0.48 1" rotation = "-1.0 0.0 -0.0 2.4784" > 
       <Shape USE = "H" > 
       </Shape> 
     </Transform> 
     <Transform translation = "0.0 0.19 -0.03" scale = "1 0.48 1" rotation = "1.0 -0.0 -0.0 2.4784" > 
       <Shape USE = "O" > 
       </Shape> 
     </Transform> 
     <Transform translation = "0.0 -0.19 -0.03" scale = "1 0.48 1" rotation = "1.0 -0.0 0.0 0.6632" > 
       <Shape USE = "O" > 
       </Shape> 
     </Transform> 
   </Group> 
 </Switch> 
</Scene>
</X3D>

</div>

<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.0.min.js" ></script>
 <script >
var com = "0.00 0.00 0.05"; 
var top_pos = "0.00 0.00 4.63"; 
var front_pos = "0.00 -4.58 0.05"; 
var right_pos = "4.58 0.00 0.05"; 
var left_pos = "-4.58 0.00 0.05"; 
var label = "False"; 
var bond = "1.0"; 
var polyhedra = "{}"; 

		var p1 = 'False';
		var p2 = 'False';
        var dist = '';
        function set_viewpoint(view){
            if (view == "top") {
                document.getElementById('camera_persp_f75210d2').setAttribute('orientation','0 0 0 0');
                document.getElementById('camera_persp_f75210d2').setAttribute('orientation','0 0 0 0');
                document.getElementById('camera_persp_f75210d2').setAttribute('position', top_pos);
                document.getElementById('camera_ortho_f75210d2').setAttribute('orientation','0 0 0 0');
                document.getElementById('camera_ortho_f75210d2').setAttribute('position', top_pos);
            }
            else if (view == "front"){
                document.getElementById('camera_persp_f75210d2').setAttribute('orientation','1 0 0 1.57079');
                document.getElementById('camera_persp_f75210d2').setAttribute('position', front_pos);
                document.getElementById('camera_ortho_f75210d2').setAttribute('orientation','1 0 0 1.57079');
                document.getElementById('camera_ortho_f75210d2').setAttribute('position', front_pos);
                }
            else if (view == "right"){
                document.getElementById('camera_persp_f75210d2').setAttribute('orientation','0 1 0 1.57079');
                document.getElementById('camera_persp_f75210d2').setAttribute('position', right_pos);
                document.getElementById('camera_ortho_f75210d2').setAttribute('orientation','0 1 0 1.57079');
                document.getElementById('camera_ortho_f75210d2').setAttribute('position', right_pos);
            }
            else if (view == "left"){
                document.getElementById('camera_persp_f75210d2').setAttribute('orientation','0 1 0 -1.57079');
                document.getElementById('camera_persp_f75210d2').setAttribute('position', left_pos);
                document.getElementById('camera_ortho_f75210d2').setAttribute('orientation','0 1 0 -1.57079');
                document.getElementById('camera_ortho_f75210d2').setAttribute('position', left_pos);
            }
        }


        //Round a float value to x.xx format
        function roundWithTwoDecimals(value)
        {
            var x = (Math.round(value * 100)) / 100;
            var y = x.toFixed(2);
            return y;
        }
        
        //Add a onMouseover callback to every shape
        $(document).ready(function(){
            $("shape").each(function() {
                $(this).attr("onMouseover", "handleOnMouseover_shape_f75210d2(this)");
                $(this).attr("onclick", "handleClick_shape_f75210d2(this)");
            });
            //Add a onMouseover callback to every transform
            $("transform").each(function() {
                $(this).attr("onMouseover", "handleOnMouseover_transform_f75210d2(this)");
                $(this).attr("onclick", "handleClick_transform_f75210d2(this)");
            });
        });
		//Handle onMouseover on a shape
        function handleOnMouseover_shape_f75210d2(shape)
        {
            $('#lastonMouseoverObject_kind_f75210d2').html($(shape).attr("kind"));
            $('#lastonMouseoverObject_index_f75210d2').html($(shape).attr("index"));
        }
        //Handle onMouseover on a transform
        function handleOnMouseover_transform_f75210d2(transform)
        {
            var coord = $(transform).attr("translation").split(" ");
            var x = roundWithTwoDecimals(coord[0]);
            var y = roundWithTwoDecimals(coord[1]);
            var z = roundWithTwoDecimals(coord[2]);
            var position = 'x = ' + x + ' y = ' + y + ' z = ' + z;
            $('#position_f75210d2').html(position);
        }
        function handleClick_transform_f75210d2(transform)
        {
            var id = $(transform).attr("id");
            if (p1 == 'False') { 
				p1 = id; 
                scale = document.getElementById(p1).getAttribute("translation");
            $('#distance_f75210d2').html(dist);
				}
			else if(p2 == 'False') { 
				p2 = id; 
                calculate_distance_f75210d2(p1, p2);
                p1 = 'False';
                p2 = 'False';
                dist = '';
			}
        }
		function calculate_distance_f75210d2(p1, p2)
        {
            var c1 = document.getElementById(p1).getAttribute("translation").split(" ");
            var c2 = document.getElementById(p2).getAttribute("translation").split(" ");
            r = (c1[0] - c2[0])*(c1[0] - c2[0]) + (c1[1] - c2[1])*(c1[1] - c2[1]) + (c1[2] - c2[2])*(c1[2] - c2[2]);
            r = roundWithTwoDecimals(Math.sqrt(r));
            var dist = 'Distance:  ' + r;
            $('#distance_f75210d2').html(dist);
            p1 = 'False';
            p2 = 'False';
        }

        //Handle models
        function ballstick_f75210d2(uuid = "f75210d2")
        {
            if (bond=='False'){ alert('Please set bond parameter in your code, e.g. bond=1.0!')}
            var objs = document.getElementsByName(''.concat('at_', uuid));
            var max=objs.length;
            for (var i=0; i< max; i++) {
                objs[i].setAttribute("scale", "0.6, 0.6, 0.6");
                }
            document.getElementById('bs_f75210d2').setAttribute("whichChoice", '0');
            document.getElementById('ps_f75210d2').setAttribute("whichChoice", '-1');
        }
        function spacefilling_f75210d2(uuid = "f75210d2")
        {
            var objs = document.getElementsByName(''.concat('at_', uuid));
            var max=objs.length;
            for (var i=0; i< max; i++) {
                objs[i].setAttribute("scale", "1.0, 1.0, 1.0");
                }
            document.getElementById('bs_f75210d2').setAttribute("whichChoice", '-1');
            document.getElementById('ps_f75210d2').setAttribute("whichChoice", '-1');
        }
        function polyhedra_f75210d2(uuid = "f75210d2")
        {
            if (polyhedra=='{}'){ alert('Please set polyhedra parameter in your code, e.g. polyhedra={"Ti": ["O"]}!')}
            var objs = document.getElementsByName(''.concat('at_', uuid));
            var max=objs.length;
            for (var i=0; i< max; i++) {
                objs[i].setAttribute("scale", "0.6, 0.6, 0.6");
                }
            document.getElementById('bs_f75210d2').setAttribute("whichChoice", '0');
            document.getElementById('ps_f75210d2').setAttribute("whichChoice", '0');
        }
        function none_f75210d2(uuid = "f75210d2")
        {
            var objs = document.getElementsByName(''.concat('am_', uuid));
            var max=objs.length;
            for (var i=0; i< max; i++) {
                objs[i].setAttribute("transparency", "0.0");
                }
            document.getElementById('ele_f75210d2').setAttribute("whichChoice", '-1');
            document.getElementById('ind_f75210d2').setAttribute("whichChoice", '-1');
        }
        
        function element_f75210d2(uuid = "f75210d2")
        {
            if (label=='False'){ 
            	$('#error_f75210d2').html('(^_^) To show element, please set label=True in your code!');
				return ;
			}
            var objs = document.getElementsByName(''.concat('am_', uuid));
            var max=objs.length;
            for (var i=0; i< max; i++) {
                objs[i].setAttribute("transparency", "0.4");
                }
            document.getElementById('ele_f75210d2').setAttribute("whichChoice", '0');
            document.getElementById('ind_f75210d2').setAttribute("whichChoice", '-1');
            document.getElementById('bs_f75210d2').setAttribute("whichChoice", '-1');
        }
        function index_f75210d2(uuid = "f75210d2")
        {
            if (label=='False'){ 
            	$('#error_f75210d2').html('(^_^) To show index, please set label=True in your code!');
				return ;
			}
            var objs = document.getElementsByName(''.concat('am_', uuid));
            var max=objs.length;
            for (var i=0; i< max; i++) {
                objs[i].setAttribute("transparency", "0.4");
                }
            document.getElementById('ind_f75210d2').setAttribute("whichChoice", '0');
            document.getElementById('ele_f75210d2').setAttribute("whichChoice", '-1');
            document.getElementById('bs_f75210d2').setAttribute("whichChoice", '-1');
        }
 </script> 
</body>
</html>
